"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * Helper class for managing cookies.
 */
class Cookies {
    constructor() {
        this.cookies = {};
    }
    /**
     * Update the cookies based on 'set-cookie' headers of a response.
     * @param response http response containing a headers object
     */
    setCookie(response) {
        if (response.headers && response.headers['set-cookie']) {
            response.headers['set-cookie'].forEach((cookieString) => this.addCookie(cookieString));
        }
        return this;
    }
    /**
     * Update cookies based on a string representing a cookie
     * @param cookieString string representing a cookie
     */
    addCookie(cookieString) {
        const cookie = cookieString.split(';');
        const [, key, value] = cookie[0].match(/(.*?)=(.*)/);
        if (cookieString.indexOf('Max-Age=0') >= 0) {
            delete this.cookies[key];
        }
        else {
            if (key && value)
                this.cookies[key] = value;
        }
        return this;
    }
    /**
     * Serialize all cookies as string formatted for the 'Cookie' header.
     */
    toString() {
        const cookies = [];
        Object.keys(this.cookies).forEach((key) => {
            cookies.push(`${key}=${this.cookies[key]}`);
        });
        return cookies.join('; ');
    }
}
exports.Cookies = Cookies;
//# sourceMappingURL=cookies.js.map