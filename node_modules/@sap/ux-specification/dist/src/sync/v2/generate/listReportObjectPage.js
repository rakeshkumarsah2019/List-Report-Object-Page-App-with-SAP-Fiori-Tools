"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const common_1 = require("../../common");
const utils_1 = require("./utils");
/**
 * Generates an app specific schema out of the generic schema.
 * Generic types are replaced by information from the app specific annotations.
 *
 * @param genericSchema - generic JSON schema of a list report
 * @param entitySet - the base entity type of the given page
 * @param annotations - list of all annotation files (file content plus URI as identifier)
 */
function generateListReportSchemaV2(genericSchema, entitySet, entityTypes) {
    const lineItemAnnotation = entityTypes.find((et) => et.name === entitySet).annotations.UI.LineItem;
    const lineItemIDs = common_1.getLineItemsTyped(lineItemAnnotation);
    const appSchema = JSON.parse(JSON.stringify(genericSchema));
    appSchema['properties']['table']['anyOf']['0']['$ref'] = '#/definitions/ResponsiveTable<LineItems>';
    appSchema['properties']['table']['anyOf']['1']['$ref'] = '#/definitions/TreeTable<LineItems>';
    appSchema['properties']['table']['anyOf']['2']['$ref'] = '#/definitions/AnalyticalTable<LineItems>';
    appSchema['properties']['table']['anyOf']['3']['$ref'] = '#/definitions/GridTable<LineItems>';
    const responsiveTableDefinition = JSON.parse(JSON.stringify(appSchema['definitions']['ResponsiveTable<GenericColumns>']));
    const treeTableDefinition = JSON.parse(JSON.stringify(appSchema['definitions']['TreeTable<GenericColumns>']));
    const analyticalTableDefinition = JSON.parse(JSON.stringify(appSchema['definitions']['AnalyticalTable<GenericColumns>']));
    const gridTableDefinition = JSON.parse(JSON.stringify(appSchema['definitions']['TreeTable<GenericColumns>']));
    responsiveTableDefinition['properties']['columns'] = {
        $ref: '#/definitions/LineItems'
    };
    treeTableDefinition['properties']['columns'] = {
        $ref: '#/definitions/LineItems'
    };
    analyticalTableDefinition['properties']['columns'] = {
        $ref: '#/definitions/LineItems'
    };
    gridTableDefinition['properties']['columns'] = {
        $ref: '#/definitions/LineItems'
    };
    appSchema['definitions']['ResponsiveTable<LineItems>'] = responsiveTableDefinition;
    appSchema['definitions']['TreeTable<LineItems>'] = treeTableDefinition;
    appSchema['definitions']['AnalyticalTable<LineItems>'] = analyticalTableDefinition;
    appSchema['definitions']['GridTable<LineItems>'] = gridTableDefinition;
    delete appSchema['definitions']['ResponsiveTable<GenericColumns>'];
    delete appSchema['definitions']['TreeTable<GenericColumns>'];
    delete appSchema['definitions']['AnalyticalTable<GenericColumns>'];
    delete appSchema['definitions']['GridTable<GenericColumns>'];
    delete appSchema['definitions']['GenericColumns'];
    utils_1.addLineItemsType(appSchema, lineItemIDs);
    return appSchema;
}
exports.generateListReportSchemaV2 = generateListReportSchemaV2;
//# sourceMappingURL=listReportObjectPage.js.map