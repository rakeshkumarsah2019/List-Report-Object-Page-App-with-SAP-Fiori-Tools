"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const page_1 = require("../../../../specification/common/page");
const controls_1 = require("../../export/controls");
const decorators_1 = require("../../../common/decoration/decorators");
const utils_1 = require("../../../common/utils");
const utils_2 = require("../utils");
function transferSettingsOfObject(object, manifest, jsonSchema, pageName) {
    let manifestSection = {};
    for (const key in jsonSchema['properties']) {
        const exportPropertyRule = decorators_1.getExportRuleMetadata(object, key);
        if (exportPropertyRule && exportPropertyRule.manifest) {
            const path = exportPropertyRule.manifest.path([pageName]);
            manifestSection = utils_1.getManifestSectionByPathV4(manifest, path);
            if (manifestSection[key]) {
                object[key] = manifestSection[key];
            }
        }
    }
}
function addSettings(listReportConfig, manifest, jsonSchema, pageName) {
    // Check table settings from target structure
    listReportConfig.table = new controls_1.Table();
    transferSettingsOfObject(listReportConfig.table, manifest, jsonSchema['definitions']['Table'], pageName);
    // Note: no manifest settings on column or filterbar level
}
function createListReportConfig(manifest, jsonSchema) {
    const v4Pages = manifest['sap.ui5']['routing']['targets'];
    const config = { table: {} };
    Object.keys(v4Pages).forEach((key) => {
        const v4Page = v4Pages[key];
        if ('name' in v4Page && utils_2.getPageType(v4Page.name) === page_1.PageType.ListReport) {
            addSettings(config, manifest, jsonSchema, v4Page.id);
        }
    });
    return config;
}
exports.createListReportConfig = createListReportConfig;
//# sourceMappingURL=listReport.js.map